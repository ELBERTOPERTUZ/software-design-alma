<h1 class="mb-4 fw-bold text-center">Panel de AdministraciÃ³n</h1>

<div class="my-container">
  <!-- Primera caja -->
  <div class="my-box my-box-large p-5">
      <div>
          <h2 class="fw-bold text-white fs-4"><%= t('welcome') %> ðŸ‘‹</h2>
          <h2 class="fw-bold text-white fs-4"><%= current_user.name %>!</h2>
          <p class="my-subtitle"><%= t('message_help_1') %></p>
          <p class="my-subtitle"><%= t('message_help_2') %></p>
          <a href="https://gooivan.github.io/software-design-alma/" class="btn btn-primary mt-3 w-50 fw-bold">
            <%= t('go_now') %>
          </a>
      </div>
      <%= render 'shared/icon_help'%>
  </div>

  <!-- Segunda caja -->
  <div class="my-box my-box-small">
    <div class="carousel">
      <div class="carousel-dots">
        <% 3.times do |i| %>
          <span class="carousel-dot" data-index="<%= i %>"></span>
        <% end %>
      </div>
      <button class="carousel-btn prev">&larr;</button>
      <div class="carousel-images">
        <%= image_tag("https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-6.webp", class: "carousel-image") %>
        <%= image_tag("https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-5.webp", class: "carousel-image") %>
        <%= image_tag("https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-4.webp", class: "carousel-image") %>
      </div>
      <button class="carousel-btn next">&rarr;</button>
    </div>
  </div>
</div>

<!-- Contenedor principal en columna -->
<div class="mt-4 d-flex flex-column gap-4 div-cards">

  <!-- Primera tarjeta: Total Users -->
  <div class="cards shadow-sm p-4 d-flex flex-row justify-content-between align-items-center w-33">
    <!-- Columna izquierda: texto -->
    <div class="d-flex flex-column justify-content-center">
      <div class="fw-bold mb-1">
        <%= t('total_active_users') %>
      </div>
      <div class="fs-3 fw-bold mb-1"><%= @users.all.size %></div>
      <div class="d-flex align-items-center gap-2 text-success">
        <img src="<%= asset_path('admins/ic-levelup.svg') %>" class="icon-levelup" alt="Level up icon">
        <div class="text-dark fs-6 fw-bold"><%= users_growth_percentage %> 
          <span class="text-gray fw-normal">
            <%= t("last_7_days") %>
          </span> 
        </div>
      </div>
    </div>

    <!-- GrÃ¡fico a la derecha -->
    <div style="width: 120px; height: 60px;">
      <canvas
        id="usuariosChart"
        width="300"
        height="150"
        data-labels='<%= @labels.to_json.html_safe %>'
        data-values='<%= @usuarios_por_mes.to_json.html_safe %>'>
      </canvas>
    </div>
  </div>

  <!-- Segunda secciÃ³n: productos -->

    <h3 class="fw-bold mb-4">Productos por CategorÃ­a</h3>

    <% @categories.each do |category| %>
      <div class="mb-3">
        <h5 class="text-primary fw-bold"><%= category.name %></h5>
        <% if category.products.any? %>
          <% category.products.each do |product| %>
            <div class="border border-4 rounded p-2 mb-2">
              <%= product.name %>
              <p class="fw-bold">
                Stock: <%= product.stock %><br>
                $ <%= product.formatted_price %>
              </p>
            </div>
          <% end %>
        <% else %>
          <p class="text-muted ps-3">Sin productos.</p>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
