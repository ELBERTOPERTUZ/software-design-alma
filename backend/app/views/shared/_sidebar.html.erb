<nav id="sidebar" class="background-panel-admin text-dark vh-100 p-3">
  <div class="d-flex flex-column h-100">
    <a href="<%= admin_dashboard_path %>" class="text-decoration-none mb-4 d-flex align-items-center">
      <i data-feather="activity" class="me-2"></i>
      <span class="fs-4">TechNova Solutions</span>
    </a>

    <ul class="nav nav-pills flex-column mb-auto">

      <%# Desplazable de vista general  %>
      <% is_overview_active = current_page?(admin_dashboard_path) || current_page?(admin_users_path) || current_page?(admin_categories_path)%>
      <li class="nav-item">
        <a 
          class="nav-link text-h1-panel-admin d-flex align-items-center" 
          data-bs-toggle="collapse" 
          href="#overviewSubmenu" 
          role="button"
          aria-expanded="<%= is_overview_active %>" 
          aria-controls="overviewSubmenu"
        >
          <span>
            <i data-feather="home"></i> <%= t("overview") %>
          </span>
        </a>

        <div class="collapse <%= 'show' if is_overview_active %>" id="overviewSubmenu">
          <ul class="nav flex-column">
            <%= link_to admin_dashboard_path, class: "text-decoration-none" do %>
              <li class="bg-text-icon mb-2 d-flex align-items-center <%= 'active' if current_page?(admin_dashboard_path) %>">
                <img src="<%= asset_path('admins/ic-dashboard.svg') %>" class="text-icon me-2">
                <span class="text-h2-panel-admin"><%= t("home") %></span>
              </li>
            <% end %>

            <%= link_to admin_users_path, class: "text-decoration-none" do %>
              <li class="bg-text-icon mb-2 d-flex align-items-center <%= 'active' if current_page?(admin_users_path) %>">
                <img src="<%= asset_path('admins/ic-user.svg') %>" class="text-icon me-2">
                <span class="text-h2-panel-admin"><%= t("users") %></span>
              </li>
            <% end %>

            <%= link_to admin_categories_path, class: "text-decoration-none" do %>
              <li class="bg-text-icon mb-2 d-flex align-items-center <%= 'active' if current_page?(admin_categories_path) %>">
                <img src="<%= asset_path('admins/ic-user.svg') %>" class="text-icon me-2">
                <span class="text-h2-panel-admin"><%= t("categories") %></span>
              </li>
            <% end %>
          </ul>
        </div>
      </li>
    </ul>

    <hr class="text-white">

    <div class="mt-auto mb-3">
      <%= link_to home_path, class: "btn btn-success w-100" do %>
        <i data-feather="log-out" class="me-2"></i> Volver
      <% end %>
    </div>
    <div class="mt-3">
      <%= button_to destroy_user_session_path, method: :delete, class: "btn btn-success w-100" do %>
        <i data-feather="log-out" class="me-2"></i> Log out
      <% end %>
    </div>
  </div>
</nav>

<div id="backdrop" class="sidebar-backdrop"></div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('sidebarToggle');
    const backdrop = document.getElementById('backdrop');

    if (toggleBtn) {
      toggleBtn.addEventListener('click', () => {
        sidebar.classList.toggle('active');
        backdrop.style.display = sidebar.classList.contains('active') ? 'block' : 'none';
      });
    }

    backdrop.addEventListener('click', () => {
      sidebar.classList.remove('active');
      backdrop.style.display = 'none';
    });
  });
</script>